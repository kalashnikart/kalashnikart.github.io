{"version":3,"file":"app.bundle.js","mappings":"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","sources":["webpack://aframe-three-bridge/./src/style.sass","webpack://aframe-three-bridge/./src/style.sass?e8f2","webpack://aframe-three-bridge/./src/index.ts","webpack://aframe-three-bridge/./src/mindar.ts","webpack://aframe-three-bridge/./src/qr.ts","webpack://aframe-three-bridge/./src/three2unity.ts","webpack://aframe-three-bridge/./src/unity.ts","webpack://aframe-three-bridge/./src/utils.ts"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"* {\\n  margin: 0;\\n}\\n\\nbody {\\n  margin: 0;\\n  height: 100vh;\\n  width: 100vw;\\n  overflow: hidden;\\n}\\n\\n#unity-container {\\n  position: fixed;\\n  z-index: 998;\\n  left: 0;\\n  top: 0;\\n  width: 100vw;\\n  height: 100vh;\\n}\\n\\n#container {\\n  display: none;\\n  opacity: 0;\\n  height: 100vh;\\n}\\n#container video, #container canvas {\\n  display: none;\\n  opacity: 0;\\n}\\n\\n.scan-box {\\n  height: 100%;\\n  width: 100%;\\n  max-width: 100vw;\\n  max-height: 100vh;\\n  display: flex;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n}\\n\\n.scan-region {\\n  margin: auto;\\n  width: 400px;\\n  height: 400px;\\n  border: 2px solid red;\\n}\\n\\n.qr-container {\\n  position: relative;\\n  height: 100vh;\\n  width: 100vw;\\n  z-index: 0;\\n  overflow: hidden;\\n}\\n.qr-container video {\\n  transform: translate(-50%, -50%) !important;\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  min-width: 100%;\\n  min-height: 100%;\\n  width: auto;\\n  height: auto;\\n  z-index: -1;\\n}\\n.qr-container .scan-region-highlight {\\n  top: 50% !important;\\n  left: 50% !important;\\n  transform: translate(-50%, -50%) !important;\\n  background: yellow;\\n  opacity: 0.5;\\n}\\n.qr-container .scan-region-highlight svg {\\n  opacity: 0;\\n  display: none;\\n}\\n\\n.logs {\\n  transform: translate(0, 0);\\n  right: 10px;\\n  top: 10px;\\n  background: #000;\\n  color: #fff;\\n  font-size: 2rem;\\n}\\n\\n@media (orientation: portrait) {\\n  .qr-container video {\\n    transform-origin: 50% 50%;\\n  }\\n  .qr-container canvas {\\n    left: 50%;\\n    top: 50%;\\n    transform-origin: 50% 50%;\\n    transform: translate(-50%, -50%);\\n    max-width: min(100vw, 100vh);\\n    max-height: min(100vw, 100vh);\\n  }\\n}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/style.sass\"],\"names\":[],\"mappings\":\"AAAA;EACE,SAAA;AACF;;AACA;EACE,SAAA;EACA,aAAA;EACA,YAAA;EACA,gBAAA;AAEF;;AAAA;EACE,eAAA;EACA,YAAA;EACA,OAAA;EACA,MAAA;EACA,YAAA;EACA,aAAA;AAGF;;AADA;EACE,aAAA;EACA,UAAA;EAEA,aAAA;AAGF;AAAE;EACE,aAAA;EACA,UAAA;AAEJ;;AAAA;EACE,YAAA;EACA,WAAA;EACA,gBAAA;EACA,iBAAA;EACA,aAAA;EACA,kBAAA;EACA,OAAA;EACA,MAAA;AAGF;;AADA;EACE,YAAA;EACA,YAAA;EACA,aAAA;EACA,qBAAA;AAIF;;AAFA;EACE,kBAAA;EACA,aAAA;EACA,YAAA;EACA,UAAA;EACA,gBAAA;AAKF;AAHE;EACE,2CAAA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,eAAA;EACA,gBAAA;EACA,WAAA;EACA,YAAA;EACA,WAAA;AAKJ;AAHE;EACE,mBAAA;EACA,oBAAA;EACA,2CAAA;EACA,kBAAA;EACA,YAAA;AAKJ;AAJI;EACE,UAAA;EACA,aAAA;AAMN;;AAJA;EACE,0BAAA;EACA,WAAA;EACA,SAAA;EACA,gBAAA;EACA,WAAA;EACA,eAAA;AAOF;;AALA;EAEI;IACE,yBAAA;EAOJ;EALE;IACE,SAAA;IACA,QAAA;IACA,yBAAA;IAEA,gCAAA;IACA,4BAAA;IACA,6BAAA;EAMJ;AACF\",\"sourcesContent\":[\"*\\n  margin: 0\\n\\nbody\\n  margin: 0\\n  height: 100vh\\n  width: 100vw\\n  overflow: hidden\\n\\n#unity-container\\n  position: fixed\\n  z-index: 998\\n  left: 0\\n  top: 0\\n  width: 100vw\\n  height: 100vh\\n\\n#container\\n  display: none\\n  opacity: 0\\n  // width: 100vw\\n  height: 100vh\\n  // position: relative\\n  // overflow: hidden\\n  video, canvas\\n    display: none\\n    opacity: 0\\n\\n.scan-box\\n  height: 100%\\n  width: 100%\\n  max-width: 100vw\\n  max-height: 100vh\\n  display: flex\\n  position: absolute\\n  left: 0\\n  top: 0\\n\\n.scan-region\\n  margin: auto\\n  width: 400px\\n  height: 400px\\n  border: 2px solid red\\n\\n.qr-container\\n  position: relative\\n  height: 100vh\\n  width: 100vw\\n  z-index: 0\\n  overflow: hidden\\n\\n  video\\n    transform: translate(-50%, -50%) !important\\n    position: absolute\\n    top: 50%\\n    left: 50%\\n    min-width: 100%\\n    min-height: 100%\\n    width: auto\\n    height: auto\\n    z-index: -1\\n\\n  .scan-region-highlight\\n    top: 50% !important\\n    left: 50% !important\\n    transform: translate(-50%,-50%) !important\\n    background: yellow\\n    opacity: .5\\n    svg\\n      opacity: 0\\n      display: none\\n\\n.logs\\n  transform: translate(0,0)\\n  right: 10px\\n  top: 10px\\n  background: #000\\n  color: #fff\\n  font-size: 2rem\\n\\n@media (orientation: portrait)\\n  .qr-container\\n    video\\n      transform-origin: 50% 50%\\n      // transform: translate(-50%, -50%) scale(.7) !important\\n    canvas\\n      left: 50%\\n      top: 50%\\n      transform-origin: 50% 50%\\n      // transform: translate(-50%, -50%) scale(.35)\\n      transform: translate(-50%, -50%)\\n      max-width: min(100vw, 100vh)\\n      max-height: min(100vw, 100vh)\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./style.sass\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./style.sass\";\n       export default content && content.locals ? content.locals : undefined;\n","import './style.sass';\nimport QRScanner from './qr';\nimport ImageTracker from './mindar';\nimport { Subject } from 'rxjs';\n\nconst getQRID = (s: string): string => s.split('/').reverse()[0] as string;\nlet state = '';\n// const logs = document.querySelector('.logs') as HTMLElement;\n\nconst imageTracker = new ImageTracker();\nimageTracker.init().then(() => {\n  const qrscanner = new QRScanner();\n  qrscanner.scan().then((subject: Subject<string>) => {\n    subject.subscribe(r => {\n      const tid = getQRID(r);\n      if (state === tid) return;\n      else {\n        state = tid;\n        // logs.innerText = `${Date.now()} | ${tid}`;\n        imageTracker.setMindAR(tid);\n      }\n    });\n  });\n});\n\n// /**\n//  * QR ONLY WHEN NO ANCHOR FOUND\n//  * trigger on acnhor.lost\n//  */\n","import './style.sass';\nimport { Unity } from './unity';\nimport { serializeMatrix4x4 } from './three2unity';\n\nconst THREE = window.MINDAR.IMAGE.THREE;\n\nexport default class ImageTracker {\n  private unity: any;\n  private mindarThree: any;\n  private renderer: THREE.WebGLRenderer | undefined | null;\n  private camera: THREE.PerspectiveCamera | undefined | null;\n  private scene: THREE.Scene | undefined | null;\n  private anchor: any;\n  private rendering = false;\n  private mindid: string = 'Test';\n  private started = false;\n\n  constructor() {}\n\n  public async init() {\n    this.unity = new Unity();\n    await this.unity.init();\n    this.unity.setInvisible();\n  }\n\n  private kill() {\n    this.rendering = false;\n    const els = document.querySelectorAll('.mindar-ui-overlay');\n    els.forEach(e => document.body.removeChild(e));\n    this.unity.setInvisible();\n    this.mindarThree?.stop();\n    this.renderer?.dispose();\n    if (this.anchor) {\n      this.anchor.onTargetFound = null;\n      this.anchor.onTargetLost = null;\n      this.anchor = null;\n    }\n    this.renderer = null;\n    this.scene = null;\n    this.camera = null;\n    this.mindarThree = null;\n  }\n\n  public async resetTarget(mindid: string) {\n    this.mindid = mindid;\n    this.mindarThree.stop();\n    this.mindarThree.imageTargetSrc = `./targets/${mindid}.mind`;\n    await this.runMindAR();\n    this.unity.setInvisible();\n  }\n\n  public async setMindAR(mindid: string) {\n    if (!this.started) {\n      this.mindid = mindid;\n      this.kill();\n      this.mindarThree = new window.MINDAR.IMAGE.MindARThree({\n        container: document.querySelector('#container'),\n        imageTargetSrc: `./targets/${mindid}.mind`,\n        colorSpace: 'sRGB',\n        renderer: 'colorManagement: true, physicallyCorrectLights',\n        uiError: 'no',\n        // uiLoading: 'no',\n        uiScanning: 'no'\n      });\n\n      this.renderer = this.mindarThree.renderer;\n      this.scene = this.mindarThree.scene;\n      this.camera = this.mindarThree.camera;\n\n      this.anchor = this.mindarThree.addAnchor(0);\n      this.camera && this.scene?.add(this.camera);\n\n      this.anchor.onTargetFound = this.onTargetFound;\n      this.anchor.onTargetLost = this.onTargetLost;\n\n      await this.runMindAR();\n      this.unity.setInvisible();\n    } else {\n      this.resetTarget(mindid);\n    }\n  }\n\n  private onTargetFound = () => {\n    this.unity.setVisible();\n    this.unity.msg('SetText', this.mindid);\n    this.rendering = true;\n    this.render();\n  };\n\n  private onTargetLost = () => {\n    this.unity.setInvisible();\n    this.rendering = false;\n  };\n\n  private async runMindAR() {\n    await this.mindarThree.start();\n    this.render();\n  }\n\n  private render = (): void => {\n    if (!this.rendering) return;\n    this.renderLoopCB();\n    requestAnimationFrame(this.render);\n  };\n\n  private renderLoopCB = () => {\n    this.unity.msg('SetCubeFromTHREEJS', serializeMatrix4x4(this.anchor.group.matrix));\n  };\n}\n","import QrScanner from 'qr-scanner';\nimport { Subject } from 'rxjs';\n\nexport default class QRScanner {\n  private scanner: QrScanner;\n  private video = document.getElementById('qr-video') as HTMLVideoElement;\n  private result = new Subject<string>();\n\n  constructor() {\n    this.scanner = new QrScanner(this.video, this.onDecode, {\n      maxScansPerSecond: 4\n      // highlightScanRegion: true\n      // highlightCodeOutline: true\n    });\n  }\n\n  private onDecode = (res: any) => {\n    this.result.next(res.data);\n  };\n\n  public destroy() {\n    this.scanner.stop();\n    this.scanner.destroy();\n    const qrbox = document.querySelector('.qr-container');\n    qrbox.parentElement?.removeChild(qrbox);\n  }\n\n  public scan = async (): Promise<Subject<string>> => {\n    await this.scanner.start();\n    // this.scanner.setInversionMode('both');\n    return this.result;\n  };\n}\n","const THREE = window.MINDAR.IMAGE.THREE;\n\nconst CreateRotationalMatrixThreejs = (euler: THREE.Euler) => {\n  const c1 = Math.cos(euler.x);\n  const c2 = Math.cos(euler.y);\n  const c3 = Math.cos(euler.z);\n  const s1 = Math.sin(euler.x);\n  const s2 = Math.sin(euler.y);\n  const s3 = Math.sin(euler.z);\n\n  const matrix = new THREE.Matrix4();\n\n  //   mat.m01 = 2; // 0*4 + 1\n  //   mat.m20 = 4; // 2*4 + 0\n\n  matrix.elements[0 * 4 + 0] = c2 * c3;\n  matrix.elements[0 * 4 + 1] = -c2 * s3;\n  matrix.elements[0 * 4 + 2] = s2;\n  matrix.elements[1 * 4 + 0] = c1 * s3 + c3 * s1 * s2;\n  matrix.elements[1 * 4 + 1] = c1 * c3 - s1 * s2 * s3;\n  matrix.elements[1 * 4 + 2] = -c2 * s1;\n  matrix.elements[2 * 4 + 0] = s1 * s3 - c1 * c3 * s2;\n  matrix.elements[2 * 4 + 1] = c3 * s1 + c1 * s2 * s3;\n  matrix.elements[2 * 4 + 2] = c1 * c2;\n  matrix.elements[3 * 4 + 3] = 1;\n\n  return matrix;\n};\n\nexport const ConvertThreejsEulerToUnity = (euler: THREE.Euler) => {\n  euler.x *= -1;\n  euler.z *= -1;\n  const mat = CreateRotationalMatrixThreejs(euler);\n\n  // Matrix4x4 unityMatrix = threejsMatrix;\n  mat.elements[0 * 4 + 2] *= -1;\n  mat.elements[1 * 4 + 2] *= -1;\n  mat.elements[2 * 4 + 0] *= -1;\n  mat.elements[2 * 4 + 1] *= -1;\n\n  // console.log(mat.elements);\n  //   new THREE.Quaternion().from\n  //   const quaternion = new THREE.Quaternion().setFromRotationMatrix(mat);\n  let q = new THREE.Quaternion().setFromRotationMatrix(mat);\n  // Vector3 eulerRotation = rotation.eulerAngles;\n  // quaternion.x?\n  // return eulerRotation;\n  q.w *= -1;\n  //   console.log(q);\n  return q;\n};\n\n// ConvertThreejsEulerToUnity(new THREE.Euler(1, 2, 3));\n\nexport const serializeMatrix4x4 = (matrix: THREE.Matrix4) => {\n  const p = new THREE.Vector3().setFromMatrixPosition(matrix);\n\n  const q = new THREE.Quaternion().setFromRotationMatrix(matrix);\n  const e = new THREE.Euler().setFromQuaternion(q, 'XYZ');\n\n  const s = new THREE.Vector3().setFromMatrixScale(matrix).multiplyScalar(0.5);\n\n  const es = `${e.x},${e.y},${e.z}`;\n  const ps = `${-p.x},${p.y},${p.z}`;\n  const ss = `${s.x},${s.y},${s.z}`;\n\n  return [es, ps, ss].join(',');\n};\n\n// quaternion, position, scale\n// export const serializeMatrix4x4 = (matrix: THREE.Matrix4) => {\n//   const p = new THREE.Vector3().setFromMatrixPosition(matrix);\n\n//   const q = new THREE.Quaternion().setFromRotationMatrix(matrix);\n//   const e = new THREE.Euler().setFromQuaternion(q, 'XYZ');\n//   const uq = ConvertThreejsEulerToUnity(e);\n\n//   const s = new THREE.Vector3().setFromMatrixScale(matrix).multiplyScalar(0.5);\n\n//   const us = `${uq.x},${uq.y},${uq.z},${uq.w}`;\n//   const ps = `${-p.x},${p.y},${p.z}`;\n//   const ss = `${s.x},${s.y},${s.z}`;\n\n//   return [us, ps, ss].join(',');\n// };\n\n// export const unityRotation =\n","import { loadScript } from './utils';\n\nconst buildUrl = 'Build';\nconst loaderUrl = buildUrl + '/pr1.loader.js';\nconst config = {\n  dataUrl: buildUrl + '/pr1.data',\n  frameworkUrl: buildUrl + '/pr1.framework.js',\n  codeUrl: buildUrl + '/pr1.wasm'\n};\n\nexport class Unity {\n  private canvas = document.querySelector('#unity-canvas') as HTMLElement;\n  public unityInstance: any | undefined;\n\n  constructor() {}\n\n  async init() {\n    await loadScript(loaderUrl);\n    this.unityInstance = await createUnityInstance(this.canvas, config);\n  }\n\n  public msg(func: string, params?: string) {\n    this.unityInstance?.SendMessage('NewBehaviourScript', func, params);\n  }\n\n  public setVisible() {\n    this.unityInstance?.SendMessage('Main Camera', 'SetVisible');\n  }\n\n  public setInvisible() {\n    this.unityInstance?.SendMessage('Main Camera', 'SetInvisible');\n  }\n}\n","export function loadScript(src: string) {\n  return new Promise(function (resolve, reject) {\n    const s: any = document.createElement('script');\n    s.src = src;\n    s.onload = resolve;\n    s.onerror = reject;\n    document.body.appendChild(s);\n  });\n}\n"],"names":["___CSS_LOADER_EXPORT___","push","module","id","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","state","imageTracker","init","then","scan","subject","subscribe","r","tid","split","reverse","setMindAR","window","MINDAR","IMAGE","THREE","ImageTracker","constructor","rendering","mindid","started","onTargetFound","this","unity","setVisible","msg","render","onTargetLost","setInvisible","renderLoopCB","requestAnimationFrame","serializeMatrix4x4","anchor","group","matrix","Unity","kill","document","querySelectorAll","forEach","e","body","removeChild","mindarThree","stop","renderer","dispose","scene","camera","resetTarget","imageTargetSrc","runMindAR","MindARThree","container","querySelector","colorSpace","uiError","uiScanning","addAnchor","add","start","QRScanner","video","getElementById","result","Subject","onDecode","res","next","data","scanner","maxScansPerSecond","destroy","qrbox","parentElement","ConvertThreejsEulerToUnity","euler","x","z","mat","c1","Math","cos","c2","y","c3","s1","sin","s2","s3","Matrix4","elements","CreateRotationalMatrixThreejs","q","Quaternion","setFromRotationMatrix","w","p","Vector3","setFromMatrixPosition","Euler","setFromQuaternion","s","setFromMatrixScale","multiplyScalar","join","config","dataUrl","buildUrl","frameworkUrl","codeUrl","canvas","loadScript","unityInstance","createUnityInstance","func","params","SendMessage","src","Promise","resolve","reject","createElement","onload","onerror","appendChild"],"sourceRoot":""}
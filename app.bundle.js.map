{"version":3,"file":"app.bundle.js","mappings":"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","sources":["webpack://webxr-image-recognizer/./src/index.ts","webpack://webxr-image-recognizer/./src/unity/index.ts"],"sourcesContent":["import { initUnity } from './unity';\n\nconst setControls = (unityInstance: any) => {\n  document.addEventListener('keydown', event => {\n    if (event.key === 'r') {\n      unityInstance.SendMessage('NewBehaviourScript', 'SetDirRight');\n    }\n    if (event.key === 'u') {\n      unityInstance.SendMessage('NewBehaviourScript', 'SetDirUp');\n    }\n  });\n};\n\nconst serializeV3 = (vec3: any) => {\n  return `${vec3.x},${vec3.y},${vec3.z}`;\n};\n\nconst initARJS = async () => {\n  const unityInstance = await initUnity();\n  // console.log('----', unityInstance);\n  // setControls(unityInstance);\n\n  const camera = document.querySelector('[camera]') as any;\n  const marker = document.querySelector('a-marker') as any;\n  let check: any;\n  marker.addEventListener('markerFound', () => {\n    let cameraPosition = camera.object3D.position;\n    let markerPosition = marker.object3D.position;\n    // let distance = cameraPosition.distanceTo(markerPosition);\n    check = setInterval(() => {\n      cameraPosition = camera.object3D.position;\n      markerPosition = marker.object3D.position;\n\n      unityInstance.SendMessage('NewBehaviourScript', 'SetPosArgs', serializeV3(markerPosition));\n      unityInstance.SendMessage('NewBehaviourScript', 'SetCamPos', serializeV3(cameraPosition));\n      // console.log(serializeV3(markerPosition));\n      // console.log(camera.object3D, marker.object3D);\n    }, 100);\n  });\n  marker.addEventListener('markerLost', () => {\n    clearInterval(check);\n  });\n};\n\ninitARJS();\n","function unityShowBanner(msg: any, type?: any) {\n  console.log('unity msg:', 'type', type, 'msg', msg);\n}\n\nvar buildUrl = 'Build';\nvar loaderUrl = buildUrl + '/pr1.loader.js';\nvar config = {\n  dataUrl: buildUrl + '/pr1.data',\n  frameworkUrl: buildUrl + '/pr1.framework.js',\n  codeUrl: buildUrl + '/pr1.wasm',\n  streamingAssetsUrl: 'StreamingAssets',\n  companyName: 'DefaultCompany',\n  productName: 'My project',\n  productVersion: '0.1',\n  showBanner: unityShowBanner\n};\n\n// By default Unity keeps WebGL canvas render target size matched with\n// the DOM size of the canvas element (scaled by window.devicePixelRatio)\n// Set this to false if you want to decouple this synchronization from\n// happening inside the engine, and you would instead like to size up\n// the canvas DOM size and WebGL render target sizes yourself.\n// config.matchWebGLToCanvasSize = false;\n\nfunction loadScript(src: string) {\n  return new Promise(function (resolve, reject) {\n    var s;\n    s = document.createElement('script');\n    s.src = src;\n    s.onload = resolve;\n    s.onerror = reject;\n    document.body.appendChild(s);\n  });\n}\n\nexport const initUnity = async () => {\n  var container = document.querySelector('#unity-container') as HTMLElement;\n  var canvas = document.querySelector('#unity-canvas') as HTMLElement;\n  var loadingBar = document.querySelector('#unity-loading-bar') as HTMLElement;\n  var progressBarFull = document.querySelector('#unity-progress-bar-full') as HTMLElement;\n  var fullscreenButton = document.querySelector('#unity-fullscreen-button') as HTMLElement;\n  // var warningBanner = document.querySelector('#unity-warning') as HTMLElement;\n\n  let unityInstanceX: any;\n  await loadScript(loaderUrl);\n  //@ts-ignore\n  await createUnityInstance(canvas, config)\n    .then((unityInstance: any) => {\n      unityInstanceX = unityInstance;\n      //init call\n      loadingBar.style.display = 'none';\n      fullscreenButton.onclick = () => {\n        unityInstance.SetFullscreen(1);\n      };\n    })\n    .catch((message: any) => alert(message));\n  return unityInstanceX;\n};\n"],"names":[],"sourceRoot":""}